# 获取结构化数据异常

## 限制条件

- 如果是网页，需要提前安装浏览器类型对应的扩展，以辅助自动化
- 获取 WEB 页面的结构化数据依赖于网页源码中的 DOM 树结构，如果非 table 元素（如，Div、Span），则无法获取对应的数据
- 获取用友 U8 界面的表格数据，需要使用指定的市场组件【FlexGrid 表格抓取】

## 常见排查步骤

1. **用循环重复做同样的操作获取网页结构化数据，为何每次获取的数据都缺少一列？**

    解决办法：

    - Step1：排查缺少的那一列的网页结构是不是 table 元素
        - 如果 Table 的 td 标签再套 Div，然后 Div 里面再有 span，有可能识别不到
    - Step2：需要再获取一次结构化数据，在“是否需要导入全部”时，选择“否”，再选择下一行数据，然后再循环两次结构化数据获取的 Datatable 整合为一个。

2. **如何使用用友 U8 获取结构化数据？**

    解决办法：

    检查识别的录制技术

    - 如果录制技术为 JAB 时可识别，则可以使用该录制技术进行获取结构化数据
    - 如果录制技术为 UIA 时可识别，则需要用市场组件【FlexGrid 表格抓取】来获取数据