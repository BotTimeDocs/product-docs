# 获取邮件(IMAP)

## 视频示例

## 概述

使用 IMAP 服务获取邮件，同时可使用代理。

## 属性

### 基本

参见 [通用配置项](../../Appendix/CommonConfigurationItems.md)。

### 服务器

- **代理** ：获取邮件时若要使用代理，则填充此属性；格式为【服务器：端口号】。
- **端口号** ：获取目标邮箱邮件时所经端口号。如，993。
- **服务器** ：获取邮件的目标邮箱所属服务器地址。如，“×××.outlook.cn”。

### 输出

- **邮件** ：将获取到的邮件存储在此变量。变量类型为 List <System.Net.Mail.MailMessage>;

### 邮件

- **获取封数** ：获取邮件的封数，默认为 1。
- **密码** ：获取邮件所属目标邮箱的密码。
- **邮件内容格式**：按需下拉选择邮件内容显示的格式，支持纯文本、HTML格式等。
- **邮件文件夹** ：指定获取邮件的文件夹。获取收件箱下邮件需填写英文 "inbox"; 若获取 inbox 下子级文件夹邮件，需使用 "/" 分隔，例如: "inbox/客户邮件"
- **邮箱地址** ：获取此邮箱地址中的邮件。如，“××@encootech.com”。

### 可选项

- **安全连接** ：指定检测加密方法，默认为自动。
- **标记为已读**：默认获取的邮件在 IMAP 中不标记为已读，勾选后则将获取的邮件标记为已读。
- **仅获取未读邮件** ：默认获取所有类型邮件，若勾选则仅获取未读邮件。

## 使用示例

**此流程执行逻辑**：获取 IMAP 服务账号中“收件箱”中的邮件。

![配置获取邮件(IMAP)组件](https://docimages.blob.core.chinacloudapi.cn/images/Activities/GetMailIMAP2020122302.png)
