# 邮件触发器(IMAP)

邮件触发器（IMAP）用于监听支持 IMAP 协议的邮箱接收新邮件事件，设置特定触发条件，满足条件时自动执行流程。

## 属性

### 基本

- **显示名称** ：默认为该组件的名称。支持更改，用户自定义此组件的显示名称
- **失败后继续** ：设置当此组件运行失败时，是否忽略此错误继续运行下一个组件。下拉框选择，当选择"是"时，如果该组件运行时遇到错误，该流程也会继续执行下一个组件，并不会停止；当选择"否"时，如果该组件运行时遇到错误，该流程将会停止执行并抛出错误
- **前延时(毫秒)** ：指定在此组件执行前的等待时间。单位为毫秒（ms）,1000ms = 1s。若此处填写1000，意为上一个组件执行完毕后，等待一秒钟后执行此组件
- **后延时(毫秒)** ：指定在此组件执行后的延迟时间。单位为毫秒（ms）,1000ms = 1s。若此处填写1000，意为此组件执行完毕后，等待一秒钟后执行下一个组件

### 服务器

- **服务器** ：输入被监听的服务器地址。仅支持字符串变量和字符串
- **端口号** ：输入被监听的端口号。仅支持整型变量和字符串

### 邮件

- **邮箱地址** ：输入被监听的邮箱地址。仅支持字符串变量和字符串
- **密码** ：输入被监听邮箱对应的密码。仅支持字符串变量和字符串

### 可选项

- **安全连接** ：指定检测加密方法，默认为自动；选项包括：无、自动、SSL、STARTTLS、如果支持STARTTLS则使用
- **发件人** ：输入监听的邮件中发件人邮箱地址；支持多个，多个则以英文分号分隔；新邮件中包含其中一个发件人则视为满足触发条件；可接变量
- **附件** ：选择是否监听有附件的新邮件
- **文件夹** ：输入被监听的邮箱文件夹（根据本机所安装Outlook语言版本而设置：例如英文版写 “inbox”, 中文版写 “收件箱”）；为空则监听整个收件箱；可接变量

  > **说明：**
  > 
  > 以中文版为例：若监听子文件夹需填写 “收件箱/文件夹名称”，若只填写“收件箱”监听不到子文件夹邮件。

- **标题关键字** ：输入监听新邮件中包含的标题关键字；支持多个，多个则以英文分号分隔；新邮件中包含其中一个标题关键字则视为满足触发条件；可接变量
- **超时** ：输入超时时间，格式：时:分:秒

### 输出

- **新邮件** ：输出监听到的新邮件。仅支持System.Net.Mail.MailMessage变量

## 操作样例
1. 以Outlook邮箱举例，拖入**邮件触发器(IMAP)**，新建变量`newmail`，变量类型为`MailMessage`，**输入**服务器`"imap-mail.outlook.com"`，端口号`993`，**输入**邮件地址和密码，**输出**新邮件`newmail`，如下图所示：
   ![](https://docimages.blob.core.chinacloudapi.cn/images/Activities/IMAPTrigger1.png)
2. 拖入**写入日志**组件，打印邮件内容，输入**日志内容**`newmail.Body`，运行程序，在运行的过程中，往此邮箱中发送一封邮件，Outlook服务器收到邮件后，触发器(IMAP)检测到新邮件，观察打印结果，打印此新增邮件的内容，如下图所示：
   ![](https://docimages.blob.core.chinacloudapi.cn/images/Activities/IMAPTrigger2.png)
