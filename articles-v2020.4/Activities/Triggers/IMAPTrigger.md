# 邮件触发器(IMAP)

## 视频示例

<video controls height='100%' width='100%' src="https://encooacademy.oss-cn-shanghai.aliyuncs.com/activity/IMAPTrigger.mp4"></video>

## 概述

邮件触发器（IMAP）用于监听支持 IMAP 协议的邮箱接收新邮件事件，设置特定触发条件，满足条件时自动执行流程。

## 属性

### 基本

参见 [通用配置项](../Appendix/CommonConfigurationItems.md)。

### 服务器

- **服务器** ：输入被监听的服务器地址。
- **端口号** ：输入被监听的端口号。

### 邮件

- **邮箱地址** ：输入被监听的邮箱地址。
- **密码** ：输入被监听邮箱对应的密码。

### 输出

- **新邮件** ：输出监听到的新邮件。仅支持 System.Net.Mail.MailMessage 变量。

### 可选项

- **安全连接** ：指定检测加密方法，默认为自动。
- **发件人** ：输入监听的邮件中发件人邮箱地址；支持多个，多个则以英文分号分隔；新邮件中包含其中一个发件人则视为满足触发条件。
- **附件** ：选择是否监听有附件的新邮件。
- **文件夹** ：输入被监听的邮箱文件夹（根据本机所安装 Outlook 语言版本而设置：例如英文版写 “inbox”, 中文版写 “收件箱”）；为空则监听整个收件箱。

  > **说明：**
  >
  > 以中文版为例：若监听子文件夹需填写 “收件箱/文件夹名称”，若只填写“收件箱”监听不到子文件夹邮件。

- **标题关键字** ：输入监听新邮件中包含的标题关键字；支持多个，多个则以英文分号分隔；新邮件中包含其中一个标题关键字则视为满足触发条件；可接变量
- **超时** ：输入超时时间，格式：时: 分: 秒

## 使用示例

**此流程执行逻辑**：监控指定 Outlook 邮箱的 IMAP 邮件服务器中有新邮件时，在输出窗口中打印出新增邮件的内容。

![配置邮件触发器(IMAP)组件](https://docimages.blob.core.chinacloudapi.cn/images/Activities/IMAPTrigger1.png)
